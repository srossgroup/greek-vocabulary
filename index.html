<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greek Vocabulary Flashcards</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Define the card flip animation */
        /* Added perspective to the container for a 3D effect */
        .perspective-1000 {
            perspective: 1000px;
        }
        .card {
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        .card-front, .card-back {
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden; /* For Safari */
            position: absolute; /* Ensure they stack */
            width: 100%;
            height: 100%;
        }
        .card-back {
            transform: rotateY(180deg);
        }
        .is-flipped {
            transform: rotateY(180deg);
        }
        /* Use Inter font which supports Greek characters well */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* --- Toggle Switch CSS --- */
        .toggle-switch-container {
            position: fixed;
            top: 1rem; /* 16px */
            left: 1rem; /* 16px */
            z-index: 10;
            display: flex;
            align-items: center;
            background-color: white;
            padding: 0.25rem; /* 4px */
            border-radius: 9999px; /* full */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb; /* gray-200 */
            cursor: pointer;
        }
        .toggle-label {
            font-size: 0.75rem; /* 12px */
            font-weight: 500;
            padding: 0.25rem 0.5rem; /* 4px 8px */
            border-radius: 9999px; /* full */
            transition: all 0.2s ease-in-out;
        }
        .toggle-label-left {
            color: #4f46e5; /* indigo-600 */
            background-color: #e0e7ff; /* indigo-100 */
        }
        .toggle-label-right {
            color: #6b7280; /* gray-500 */
            background-color: transparent;
        }
        /* Styles when toggled */
        .toggle-switch-container.toggled .toggle-label-left {
            color: #6b7280; /* gray-500 */
            background-color: transparent;
        }
        .toggle-switch-container.toggled .toggle-label-right {
            color: #4f46e5; /* indigo-600 */
            background-color: #e0e7ff; /* indigo-100 */
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4 pt-20">

    <!-- Direction Toggle Switch -->
    <div id="direction-toggle" class="toggle-switch-container" title="Click to change direction">
        <span id="toggle-label-gr" class="toggle-label toggle-label-left">Greek â†’ English</span>
        <span id="toggle-label-en" class="toggle-label toggle-label-right">English â†’ Greek</span>
    </div>

    <div class="w-full max-w-md">
        
        <!-- Header -->
        <h1 class="text-3xl font-bold text-center text-indigo-700 mb-6">
            Î•Î»Î»Î·Î½Î¹ÎºÏŒ Î›ÎµÎ¾Î¹Î»ÏŒÎ³Î¹Î¿
            <span class="block text-xl text-gray-600 font-normal">Greek Vocabulary Flashcards</span>
        </h1>

        <!-- Dropdown Selectors -->
        <div class="flex flex-col sm:flex-row sm:space-x-4 mb-6">
            <div class="flex-1 mb-4 sm:mb-0">
                <label for="theme-select" class="block text-sm font-medium text-gray-700 mb-1">Theme</label>
                <select id="theme-select" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white">
                    <!-- Themes will be populated by JS -->
                </select>
            </div>
            <div class="flex-1">
                <label for="subtheme-select" class="block text-sm font-medium text-gray-700 mb-1">Sub-Theme</label>
                <select id="subtheme-select" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white" disabled>
                    <!-- Sub-themes will be populated by JS -->
                </select>
            </div>
        </div>

        <!-- Flashcard Container -->
        <div class="perspective-1000 w-full h-64 mb-6"> 
            <div id="flashcard" class="card relative w-full h-full cursor-pointer">
                
                <!-- Card Front -->
                <div id="card-front" class="card-front w-full h-full bg-white rounded-lg shadow-xl p-6 flex flex-col justify-between items-center border border-gray-200">
                    <div class="self-start text-sm font-medium text-gray-500" id="card-front-label">Greek</div>
                    <div class="text-3xl md:text-4xl font-bold text-indigo-600 text-center px-4" id="card-front-text">
                        Choose a Theme and Sub-Theme to practice.
                    </div>
                    <div class="text-sm text-gray-400" id="progress-indicator">...</div>
                </div>
                
                <!-- Card Back -->
                <div id="card-back" class="card-back w-full h-full bg-indigo-600 rounded-lg shadow-xl p-6 flex flex-col justify-between items-center">
                    <div class="self-start text-sm font-medium text-indigo-100" id="card-back-label">English</div>
                    <div class="text-3xl md:text-4xl font-bold text-white text-center px-4" id="card-back-text">
                        Choose a Theme and Sub-Theme to practice.
                    </div>
                    <div class="text-sm text-indigo-200">Click to flip back</div>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="flex justify-between items-center mb-4">
            <button id="prev-btn" class="bg-white text-gray-700 px-6 py-3 rounded-lg shadow-md hover:bg-gray-50 transition duration-200 disabled:opacity-40 disabled:cursor-not-allowed border border-gray-300">
                &larr; Previous
            </button>
            <button id="flip-btn" class="bg-indigo-500 text-white px-8 py-3 rounded-lg shadow-md hover:bg-indigo-600 transition duration-200 disabled:opacity-40 disabled:cursor-not-allowed font-semibold">
                Flip
            </button>
            <button id="next-btn" class="bg-white text-gray-700 px-6 py-3 rounded-lg shadow-md hover:bg-gray-50 transition duration-200 disabled:opacity-40 disabled:cursor-not-allowed border border-gray-300">
                Next &rarr;
            </button>
        </div>

    </div>

    <!-- Reset Button -->
    <button id="reset-btn" title="Reset to start" class="fixed bottom-4 left-4 bg-white text-gray-700 p-3 rounded-full shadow-lg border border-gray-300 hover:bg-orange-300 transition duration-200">
        <!-- Refresh Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m-15.357-2a8.001 8.001 0 0015.357 2m0 0H15" />
        </svg>
    </button>

    <!-- Help Button (Desktop Only) -->
    <button id="help-btn" title="Show controls" class="fixed bottom-4 right-4 bg-white text-gray-700 rounded-full shadow-lg border border-gray-300 hover:bg-blue-100 transition duration-200 z-10 h-12 w-12 hidden items-center justify-center md:flex">
        <!-- Question Mark Icon (Minimal) -->
        <span class="text-xl font-bold text-gray-600">?</span>
    </button>

    <!-- Help Modal -->
    <div id="help-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm mx-auto">
            <h2 class="text-xl font-bold text-indigo-700 mb-4">Keyboard Controls</h2>
            <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li><span class="font-semibold text-indigo-600">&larr; (Left Arrow):</span> Go to previous card</li>
                <li><span class="font-semibold text-indigo-600">&rarr; (Right Arrow):</span> Go to next card</li>
                <li><span class="font-semibold text-indigo-600">Spacebar / &uarr; / &darr;:</span> Flip the card</li>
            </ul>
            <button id="close-modal-btn" class="mt-6 w-full bg-indigo-500 text-white px-4 py-2 rounded-lg shadow hover:bg-indigo-600 transition duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-400">
                Got it!
            </button>
        </div>
    </div>


    <script>
        // --- DATA ---
        
        // --- Greek Number Generation Helpers ---
        const GREEK_NUMBERS = {
            units: [
                "", "Î­Î½Î±", "Î´ÏÎ¿", "Ï„ÏÎ¯Î±", "Ï„Î­ÏƒÏƒÎµÏÎ±", "Ï€Î­Î½Ï„Îµ", "Î­Î¾Î¹", "ÎµÏ€Ï„Î¬", "Î¿ÎºÏ„ÏŽ", "ÎµÎ½Î½Î­Î±"
            ],
            teens: [
                "Î´Î­ÎºÎ±", "Î­Î½Ï„ÎµÎºÎ±", "Î´ÏŽÎ´ÎµÎºÎ±", "Î´ÎµÎºÎ±Ï„ÏÎ¯Î±", "Î´ÎµÎºÎ±Ï„Î­ÏƒÏƒÎµÏÎ±", "Î´ÎµÎºÎ±Ï€Î­Î½Ï„Îµ", "Î´ÎµÎºÎ±Î­Î¾Î¹", "Î´ÎµÎºÎ±ÎµÏ€Ï„Î¬", "Î´ÎµÎºÎ±Î¿ÎºÏ„ÏŽ", "Î´ÎµÎºÎ±ÎµÎ½Î½Î­Î±"
            ],
            tens: [
                "", "Î´Î­ÎºÎ±", "ÎµÎ¯ÎºÎ¿ÏƒÎ¹", "Ï„ÏÎ¹Î¬Î½Ï„Î±", "ÏƒÎ±ÏÎ¬Î½Ï„Î±", "Ï€ÎµÎ½Î®Î½Ï„Î±", "ÎµÎ¾Î®Î½Ï„Î±", "ÎµÎ²Î´Î¿Î¼Î®Î½Ï„Î±", "Î¿Î³Î´ÏŒÎ½Ï„Î±", "ÎµÎ½ÎµÎ½Î®Î½Ï„Î±"
            ],
            hundreds: [
                "", "ÎµÎºÎ±Ï„ÏŒÎ½", // Special case for 100-199
                "Î´Î¹Î±ÎºÏŒÏƒÎ¹Î±", "Ï„ÏÎ¹Î±ÎºÏŒÏƒÎ¹Î±", "Ï„ÎµÏ„ÏÎ±ÎºÏŒÏƒÎ¹Î±", "Ï€ÎµÎ½Ï„Î±ÎºÏŒÏƒÎ¹Î±", "ÎµÎ¾Î±ÎºÏŒÏƒÎ¹Î±", "ÎµÏ€Ï„Î±ÎºÏŒÏƒÎ¹Î±", "Î¿ÎºÏ„Î±ÎºÏŒÏƒÎ¹Î±", "ÎµÎ½Î½Î¹Î±ÎºÏŒÏƒÎ¹Î±"
            ]
        };

        /**
         * Converts a number (1-1000) into its Greek word representation.
         * @param {number} num - The number to convert.
         * @returns {string} The number in Greek.
         */
        function convertNumberToGreek(num) {
            if (num === 0) return "Î¼Î·Î´Î­Î½";
            if (num === 1000) return "Ï‡Î¯Î»Î¹Î±";

            let parts = [];
            
            const h = Math.floor(num / 100);
            const t = Math.floor((num % 100) / 10);
            const u = num % 10;

            // Handle Hundreds
            if (h > 0) {
                if (h === 1) {
                    // 'ÎµÎºÎ±Ï„ÏŒÎ½' if followed by something, 'ÎµÎºÎ±Ï„ÏŒ' if exactly 100
                    parts.push(num === 100 ? "ÎµÎºÎ±Ï„ÏŒ" : "ÎµÎºÎ±Ï„ÏŒÎ½");
                } else {
                    parts.push(GREEK_NUMBERS.hundreds[h]);
                }
            }

            // Handle Tens and Units
            const tensAndUnits = num % 100;
            if (tensAndUnits > 0) {
                if (tensAndUnits >= 10 && tensAndUnits <= 19) {
                    parts.push(GREEK_NUMBERS.teens[tensAndUnits - 10]);
                } else {
                    if (t > 0) {
                        parts.push(GREEK_NUMBERS.tens[t]);
                    }
                    if (u > 0) {
                        parts.push(GREEK_NUMBERS.units[u]);
                    }
                }
            }
            
            return parts.join(" ");
        }

        /**
         * Generates a specified number of unique random flashcards in a given range.
         * @param {number} min - The minimum number.
         * @param {number} max - The maximum number.
         * @param {number} count - The number of cards to generate.
         * @returns {Array} An array of flashcard objects.
         */
        function generateRandomNumberCards(min, max, count) {
            const cards = [];
            const usedNumbers = new Set();
            
            while (cards.length < count) {
                const randomNum = Math.floor(Math.random() * (max - min + 1)) + min;
                
                if (!usedNumbers.has(randomNum)) {
                    usedNumbers.add(randomNum);
                    cards.push({
                        english: String(randomNum),
                        greek: convertNumberToGreek(randomNum)
                    });
                }
            }
            return cards;
        }

        /**
         * Gets a random subset of cards from a given array.
         * @param {Array} array - The source array.
         * @param {number} count - The number of random cards to return.
         * @returns {Array} A new array with 'count' random cards.
         */
        function getRandomCards(array, count) {
            const shuffled = [...array]; // Create a copy
            shuffleArray(shuffled);      // Shuffle the copy
            return shuffled.slice(0, count); // Return the first 'count' items
        }
        // --- End of Number Helpers ---


        // --- NEW: Static data for Nationalities ---
        // We move this data here so we can reference it for random generation
        const NATIONALITY_DATA = {
            'Country - Î§ÏŽÏÎ±': [
                { english: 'Greece', greek: 'Î· Î•Î»Î»Î¬Î´Î±' },
                { english: 'England', greek: 'Î· Î‘Î³Î³Î»Î¯Î±' },
                { english: 'America', greek: 'Î· Î‘Î¼ÎµÏÎ¹ÎºÎ®' },
                { english: 'France', greek: 'Î· Î“Î±Î»Î»Î¯Î±' },
                { english: 'Germany', greek: 'Î· Î“ÎµÏÎ¼Î±Î½Î¯Î±' },
                { english: 'Belgium', greek: 'Ï„Î¿ Î’Î­Î»Î³Î¹Î¿' },
                { english: 'Spain', greek: 'Î· Î™ÏƒÏ€Î±Î½Î¯Î±' },
                { english: 'Italy', greek: 'Î· Î™Ï„Î±Î»Î¯Î±' },
                { english: 'Russia', greek: 'Î· Î¡Ï‰ÏƒÎ¯Î±' },
                { english: 'Australia', greek: 'Î· Î‘Ï…ÏƒÏ„ÏÎ±Î»Î¯Î±' },
                { english: 'Japan', greek: 'Î· Î™Î±Ï€Ï‰Î½Î¯Î±' },
                { english: 'China', greek: 'Î· ÎšÎ¯Î½Î±' },
                { english: 'Hungary', greek: 'Î· ÎŸÏ…Î³Î³Î±ÏÎ¯Î±' },
                { english: 'Poland', greek: 'Î· Î Î¿Î»Ï‰Î½Î¯Î±' },
                { english: 'Ukraine', greek: 'Î· ÎŸÏ…ÎºÏÎ±Î½Î¯Î±' },
                { english: 'Canada', greek: 'Î¿ ÎšÎ±Î½Î±Î´Î¬Ï‚' },
                { english: 'Congo', greek: 'Ï„Î¿ ÎšÎ¿Î½Î³ÎºÏŒ' },
                { english: 'Cameroon', greek: 'Ï„Î¿ ÎšÎ±Î¼ÎµÏÎ¿ÏÎ½' },
                { english: 'Lebanon', greek: 'Î¿ Î›Î¯Î²Î±Î½Î¿Ï‚' },
                { english: 'Philippines', greek: 'Î¿Î¹ Î¦Î¹Î»Î¹Ï€Ï€Î¯Î½ÎµÏ‚' },
                { english: 'Bulgaria', greek: 'Î· Î’Î¿Ï…Î»Î³Î±ÏÎ¯Î±' },
                { english: 'Romania', greek: 'Î· Î¡Î¿Ï…Î¼Î±Î½Î¯Î±' },
                { english: 'Czech Republic', greek: 'Î· Î¤ÏƒÎµÏ‡Î¯Î±' },
                { english: 'Syria', greek: 'Î· Î£Ï…ÏÎ¯Î±' },
                { english: 'Armenia', greek: 'Î· Î‘ÏÎ¼ÎµÎ½Î¯Î±' },
                { english: 'Brazil', greek: 'Î· Î’ÏÎ±Î¶Î¹Î»Î¯Î±' },
                { english: 'Mexico', greek: 'Ï„Î¿ ÎœÎµÎ¾Î¹ÎºÏŒ' },
                { english: 'Turkey', greek: 'Î· Î¤Î¿Ï…ÏÎºÎ¯Î±' },
                { english: 'Egypt', greek: 'Î· Î‘Î¯Î³Ï…Ï€Ï„Î¿Ï‚' },
                { english: 'Cyprus', greek: 'Î· ÎšÏÏ€ÏÎ¿Ï‚' },
                { english: 'Albania', greek: 'Î· Î‘Î»Î²Î±Î½Î¯Î±' },
                { english: 'Jordan', greek: 'Î· Î™Î¿ÏÎ´Î±Î½Î¯Î±' },
                { english: 'Iraq', greek: 'Ï„Î¿ Î™ÏÎ¬Îº' },
                { english: 'Iran', greek: 'Ï„Î¿ Î™ÏÎ¬Î½' },
                { english: 'Pakistan', greek: 'Ï„Î¿ Î Î±ÎºÎ¹ÏƒÏ„Î¬Î½' },
                { english: 'Afghanistan', greek: 'Ï„Î¿ Î‘Ï†Î³Î±Î½Î¹ÏƒÏ„Î¬Î½' },
                { english: 'Georgia', greek: 'Î· Î“ÎµÏ‰ÏÎ³Î¯Î±' },
                { english: 'India', greek: 'Î· Î™Î½Î´Î¯Î±' },
                { english: 'Chile', greek: 'Î· Î§Î¹Î»Î®' },
                { english: 'Morocco', greek: 'Î· ÎœÎ±ÏÏŒÎºÎ¿Ï‚' },
                { english: 'Sudan', greek: 'Ï„Î¿ Î£Î¿Ï…Î´Î¬Î½' },
                { english: 'Somalia', greek: 'Î· Î£Î¿Î¼Î±Î»Î¯Î±' },
                { english: 'Nigeria', greek: 'Î· ÎÎ¹Î³Î·ÏÎ¯Î±' },
                { english: 'Korea', greek: 'Î· ÎšÎ¿ÏÎ­Î±' }
            ],
            'Nationality (Male) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î±ÏÏƒÎµÎ½Î¹ÎºÏŒ)': [
                { english: 'Greek (m)', greek: 'Î¿ ÎˆÎ»Î»Î·Î½Î±Ï‚' },
                { english: 'English (m)', greek: 'Î¿ Î†Î³Î³Î»Î¿Ï‚' },
                { english: 'American (m)', greek: 'Î¿ Î‘Î¼ÎµÏÎ¹ÎºÎ±Î½ÏŒÏ‚' },
                { english: 'French (m)', greek: 'Î¿ Î“Î¬Î»Î»Î¿Ï‚' },
                { english: 'German (m)', greek: 'Î¿ Î“ÎµÏÎ¼Î±Î½ÏŒÏ‚' },
                { english: 'Belgian (m)', greek: 'Î¿ Î’Î­Î»Î³Î¿Ï‚' },
                { english: 'Spanish (m)', greek: 'Î¿ Î™ÏƒÏ€Î±Î½ÏŒÏ‚' },
                { english: 'Italian (m)', greek: 'Î¿ Î™Ï„Î±Î»ÏŒÏ‚' },
                { english: 'Russian (m)', greek: 'Î¿ Î¡ÏŽÏƒÎ¿Ï‚' },
                { english: 'Australian (m)', greek: 'Î¿ Î‘Ï…ÏƒÏ„ÏÎ±Î»ÏŒÏ‚' },
                { english: 'Japanese (m)', greek: 'Î¿ Î™Î¬Ï€Ï‰Î½Î±Ï‚' },
                { english: 'Chinese (m)', greek: 'Î¿ ÎšÎ¹Î½Î­Î¶Î¿Ï‚' },
                { english: 'Hungarian (m)', greek: 'Î¿ ÎŸÏÎ³Î³ÏÎ¿Ï‚' },
                { english: 'Polish (m)', greek: 'Î¿ Î Î¿Î»Ï‰Î½ÏŒÏ‚' },
                { english: 'Ukrainian (m)', greek: 'Î¿ ÎŸÏ…ÎºÏÎ±Î½ÏŒÏ‚' },
                { english: 'Canadian (m)', greek: 'Î¿ ÎšÎ±Î½Î±Î´ÏŒÏ‚' },
                { english: 'Congolese (m)', greek: 'Î¿ ÎšÎ¿Î½Î³ÎºÎ¿Î»Î­Î¶Î¿Ï‚' },
                { english: 'Cameroonian (m)', greek: 'Î¿ ÎšÎ±Î¼ÎµÏÎ¿Ï…Î½Î­Î¶Î¿Ï‚' },
                { english: 'Lebanese (m)', greek: 'Î¿ Î›Î¹Î²Î±Î½Î­Î¶Î¿Ï‚' },
                { english: 'Filipino (m)', greek: 'Î¿ Î¦Î¹Î»Î¹Ï€Ï€Î¹Î½Î­Î¶Î¿Ï‚' },
                { english: 'Bulgarian (m)', greek: 'Î¿ Î’Î¿ÏÎ»Î³Î±ÏÎ¿Ï‚' },
                { english: 'Romanian (m)', greek: 'Î¿ Î¡Î¿Ï…Î¼Î¬Î½Î¿Ï‚' },
                { english: 'Czech (m)', greek: 'Î¿ Î¤ÏƒÎ­Ï‡Î¿Ï‚' },
                { english: 'Syrian (m)', greek: 'Î¿ Î£ÏÏÎ¹Î¿Ï‚' },
                { english: 'Armenian (m)', greek: 'Î¿ Î‘ÏÎ¼Î­Î½Î¹Î¿Ï‚' },
                { english: 'Brazilian (m)', greek: 'Î¿ Î’ÏÎ±Î¶Î¹Î»Î¹Î¬Î½Î¿Ï‚' },
                { english: 'Mexican (m)', greek: 'Î¿ ÎœÎµÎ¾Î¹ÎºÎ±Î½ÏŒÏ‚' },
                { english: 'Turkish (m)', greek: 'Î¿ Î¤Î¿ÏÏÎºÎ¿Ï‚' },
                { english: 'Egyptian (m)', greek: 'Î¿ Î‘Î¹Î³ÏÏ€Ï„Î¹Î¿Ï‚' },
                { english: 'Cypriot (m)', greek: 'Î¿ ÎšÏÏ€ÏÎ¹Î¿Ï‚' },
                { english: 'Albanian (m)', greek: 'Î¿ Î‘Î»Î²Î±Î½ÏŒÏ‚' },
                { english: 'Jordanian (m)', greek: 'Î¿ Î™Î¿ÏÎ´Î±Î½ÏŒÏ‚' },
                { english: 'Iraqi (m)', greek: 'Î¿ Î™ÏÎ±ÎºÎ¹Î½ÏŒÏ‚' },
                { english: 'Iranian (m)', greek: 'Î¿ Î™ÏÎ±Î½ÏŒÏ‚' },
                { english: 'Pakistani (m)', greek: 'Î¿ Î Î±ÎºÎ¹ÏƒÏ„Î±Î½ÏŒÏ‚' },
                { english: 'Afghan (m)', greek: 'Î¿ Î‘Ï†Î³Î±Î½ÏŒÏ‚' },
                { english: 'Georgian (m)', greek: 'Î¿ Î“ÎµÏ‰ÏÎ³Î¹Î±Î½ÏŒÏ‚' },
                { english: 'Indian (m)', greek: 'Î¿ Î™Î½Î´ÏŒÏ‚' },
                { english: 'Chilean (m)', greek: 'Î¿ Î§Î¹Î»Î¹Î±Î½ÏŒÏ‚' },
                { english: 'Moroccan (m)', greek: 'Î¿ ÎœÎ±ÏÎ¿ÎºÎ¹Î½ÏŒÏ‚' },
                { english: 'Sudanese (m)', greek: 'Î¿ Î£Î¿Ï…Î´Î±Î½ÏŒÏ‚' },
                { english: 'Somali (m)', greek: 'Î¿ Î£Î¿Î¼Î±Î»ÏŒÏ‚' },
                { english: 'Nigerian (m)', greek: 'Î¿ ÎÎ¹Î³Î·ÏÎ¹Î±Î½ÏŒÏ‚' },
                { english: 'Korean (m)', greek: 'Î¿ ÎšÎ¿ÏÎµÎ¬Ï„Î·Ï‚' }
            ],
            'Nationality (Female) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î¸Î·Î»Ï…ÎºÏŒ)': [
                { english: 'Greek (f)', greek: 'Î· Î•Î»Î»Î·Î½Î¯Î´Î±' },
                { english: 'English (f)', greek: 'Î· Î‘Î³Î³Î»Î¯Î´Î±' },
                { english: 'American (f)', greek: 'Î· Î‘Î¼ÎµÏÎ¹ÎºÎ±Î½Î¯Î´Î±' },
                { english: 'French (f)', greek: 'Î· Î“Î±Î»Î»Î¯Î´Î±' },
                { english: 'German (f)', greek: 'Î· Î“ÎµÏÎ¼Î±Î½Î¯Î´Î±' },
                { english: 'Belgian (f)', greek: 'Î· Î’ÎµÎ»Î³Î¯Î´Î±' },
                { english: 'Spanish (f)', greek: 'Î· Î™ÏƒÏ€Î±Î½Î¯Î´Î±' },
                { english: 'Italian (f)', greek: 'Î· Î™Ï„Î±Î»Î¯Î´Î±' },
                { english: 'Russian (f)', greek: 'Î· Î¡Ï‰ÏƒÎ¯Î´Î±' },
                { english: 'Australian (f)', greek: 'Î· Î‘Ï…ÏƒÏ„ÏÎ±Î»Î­Î¶Î±' },
                { english: 'Japanese (f)', greek: 'Î· Î™Î±Ï€Ï‰Î½Î­Î¶Î±' },
                { english: 'Chinese (f)', greek: 'Î· ÎšÎ¹Î½Î­Î¶Î±' },
                { english: 'Hungarian (f)', greek: 'Î· ÎŸÏ…Î³Î³Î±ÏÎ­Î¶Î±' },
                { english: 'Polish (f)', greek: 'Î· Î Î¿Î»Ï‰Î½Î­Î¶Î±' },
                { english: 'Ukrainian (f)', greek: 'Î· ÎŸÏ…ÎºÏÎ±Î½Î®' },
                { english: 'Canadian (f)', greek: 'Î· ÎšÎ±Î½Î±Î´Î­Î¶Î±' },
                { english: 'Congolese (f)', greek: 'Î· ÎšÎ¿Î½Î³ÎºÎ¿Î»Î­Î¶Î±' },
                { english: 'Cameroonian (f)', greek: 'Î· ÎšÎ±Î¼ÎµÏÎ¿Ï…Î½Î­Î¶Î±' },
                { english: 'Lebanese (f)', greek: 'Î· Î›Î¹Î²Î±Î½Î­Î¶Î±' },
                { english: 'Filipina (f)', greek: 'Î· Î¦Î¹Î»Î¹Ï€Ï€Î¹Î½Î­Î¶Î±' },
                { english: 'Bulgarian (f)', greek: 'Î· Î’Î¿Ï…Î»Î³Î¬ÏÎ±' },
                { english: 'Romanian (f)', greek: 'Î· Î¡Î¿Ï…Î¼Î¬Î½Î±' },
                { english: 'Czech (f)', greek: 'Î· Î¤ÏƒÎ­Ï‡Î±' },
                { english: 'Syrian (f)', greek: 'Î· Î£ÏÏÎ¹Î±' },
                { english: 'Armenian (f)', greek: 'Î· Î‘ÏÎ¼Î­Î½Î¹Î±' },
                { english: 'Brazilian (f)', greek: 'Î· Î’ÏÎ±Î¶Î¹Î»Î¹Î¬Î½Î±' },
                { english: 'Mexican (f)', greek: 'Î· ÎœÎµÎ¾Î¹ÎºÎ±Î½Î®' },
                { english: 'Turkish (f)', greek: 'Î· Î¤Î¿ÏÏÎºÎ±' },
                { english: 'Egyptian (f)', greek: 'Î· Î‘Î¹Î³ÏÏ€Ï„Î¹Î±' },
                { english: 'Cypriot (f)', greek: 'Î· ÎšÏÏ€ÏÎ¹Î±' },
                { english: 'Albanian (f)', greek: 'Î· Î‘Î»Î²Î±Î½Î®' },
                { english: 'Jordanian (f)', greek: 'Î· Î™Î¿ÏÎ´Î±Î½Î®' },
                { english: 'Iraqi (f)', greek: 'Î· Î™ÏÎ±ÎºÎ¹Î½Î®' },
                { english: 'Iranian (f)', greek: 'Î· Î™ÏÎ±Î½Î®' },
                { english: 'Pakistani (f)', greek: 'Î· Î Î±ÎºÎ¹ÏƒÏ„Î±Î½Î®' },
                { english: 'Afghan (f)', greek: 'Î· Î‘Ï†Î³Î±Î½Î®' },
                { english: 'Georgian (f)', greek: 'Î· Î“ÎµÏ‰ÏÎ³Î¹Î±Î½Î®' },
                { english: 'Indian (f)', greek: 'Î· Î™Î½Î´Î®' },
                { english: 'Chilean (f)', greek: 'Î· Î§Î¹Î»Î¹Î±Î½Î®' },
                { english: 'Moroccan (f)', greek: 'Î· ÎœÎ±ÏÎ¿ÎºÎ¹Î½Î®' },
                { english: 'Sudanese (f)', greek: 'Î· Î£Î¿Ï…Î´Î±Î½Î®' },
                { english: 'Somali (f)', greek: 'Î· Î£Î¿Î¼Î±Î»Î®' },
                { english: 'Nigerian (f)', greek: 'Î· ÎÎ¹Î³Î·ÏÎ¹Î±Î½Î®' },
                { english: 'Korean (f)', greek: 'Î· ÎšÎ¿ÏÎµÎ¬Ï„Î¹ÏƒÏƒÎ±' }
            ],
            'Language - Î“Î»ÏŽÏƒÏƒÎ±': [
                { english: 'Greek', greek: 'ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬' },
                { english: 'English', greek: 'Î±Î³Î³Î»Î¹ÎºÎ¬' },
                { english: 'English', greek: 'Î±Î³Î³Î»Î¹ÎºÎ¬' },
                { english: 'French', greek: 'Î³Î±Î»Î»Î¹ÎºÎ¬' },
                { english: 'German', greek: 'Î³ÎµÏÎ¼Î±Î½Î¹ÎºÎ¬' },
                { english: 'Dutch / German / French', greek: 'Î¿Î»Î»Î±Î½Î´Î¹ÎºÎ¬ / Î³ÎµÏÎ¼Î±Î½Î¹ÎºÎ¬ / Î³Î±Î»Î»Î¹ÎºÎ¬' },
                { english: 'Spanish', greek: 'Î¹ÏƒÏ€Î±Î½Î¹ÎºÎ¬' },
                { english: 'Italian', greek: 'Î¹Ï„Î±Î»Î¹ÎºÎ¬' },
                { english: 'Russian', greek: 'ÏÏ‰ÏƒÎ¹ÎºÎ¬' },
                { english: 'English', greek: 'Î±Î³Î³Î»Î¹ÎºÎ¬' },
                { english: 'Japanese', greek: 'Î¹Î±Ï€Ï‰Î½Î¹ÎºÎ¬' },
                { english: 'Chinese', greek: 'ÎºÎ¹Î½ÎµÎ¶Î¹ÎºÎ¬' },
                { english: 'Hungarian', greek: 'Î¿Ï…Î³Î³ÏÎ¹ÎºÎ¬' },
                { english: 'Polish', greek: 'Ï€Î¿Î»Ï‰Î½Î¹ÎºÎ¬' },
                { english: 'Ukrainian', greek: 'Î¿Ï…ÎºÏÎ±Î½Î¹ÎºÎ¬' },
                { english: 'English / French', greek: 'Î±Î³Î³Î»Î¹ÎºÎ¬ / Î³Î±Î»Î»Î¹ÎºÎ¬' },
                { english: 'Lingala', greek: 'Î»Î¹Î½Î³ÎºÎ¬Î»Î±' },
                { english: 'French / English', greek: 'Î³Î±Î»Î»Î¹ÎºÎ¬ / Î±Î³Î³Î»Î¹ÎºÎ¬' },
                { english: 'Arabic', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬' },
                { english: 'Filipino', greek: 'Ï†Î¹Î»Î¹Ï€Ï€Î¹Î½Î­Î¶Î¹ÎºÎ±' },
                { english: 'Bulgarian', greek: 'Î²Î¿Ï…Î»Î³Î±ÏÎ¹ÎºÎ¬' },
                { english: 'Romanian', greek: 'ÏÎ¿Ï…Î¼Î±Î½Î¹ÎºÎ¬' },
                { english: 'Czech', greek: 'Ï„ÏƒÎ­Ï‡Î¹ÎºÎ±' },
                { english: 'Arabic', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬' },
                { english: 'Armenian', greek: 'Î±ÏÎ¼Î­Î½Î¹ÎºÎ±' },
                { english: 'Portuguese', greek: 'Ï€Î¿ÏÏ„Î¿Î³Î±Î»Î¹ÎºÎ¬' },
                { english: 'Spanish', greek: 'Î¹ÏƒÏ€Î±Î½Î¹ÎºÎ¬' },
                { english: 'Turkish', greek: 'Ï„Î¿Ï…ÏÎºÎ¹ÎºÎ¬' },
                { english: 'Arabic', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬' },
                { english: 'Greek', greek: 'ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬' },
                { english: 'Albanian', greek: 'Î±Î»Î²Î±Î½Î¹ÎºÎ¬' },
                { english: 'Arabic', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬' },
                { english: 'Arabic', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬' },
                { english: 'Arabic / Kurdish', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬ / ÎºÎ¿Ï…ÏÎ´Î¹ÎºÎ¬' },
                { english: 'Urdu', greek: 'Î¿ÏÏÎ½Ï„Î¿Ï…' },
                { english: 'Dari / Pashto', greek: 'Î½Ï„Î±ÏÎ¯ / Ï€Î±ÏƒÏ„Î¿Ï' },
                { english: 'Georgian', greek: 'Î³ÎµÏ‰ÏÎ³Î¹Î±Î½Î¬' },
                { english: 'Hindi', greek: 'Ï‡Î¯Î½Ï„Î¹' },
                { english: 'Spanish', greek: 'Î¹ÏƒÏ€Î±Î½Î¹ÎºÎ¬' },
                { english: 'Arabic', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬' },
                { english: 'Arabic', greek: 'Î±ÏÎ±Î²Î¹ÎºÎ¬' },
                { english: 'Somali', greek: 'ÏƒÎ¿Î¼Î±Î»Î¹ÎºÎ¬' },
                { english: 'Nigerian', greek: 'Î½Î¹Î³Î·ÏÎ¹Î±Î½Î¬' },
                { english: 'Korean', greek: 'ÎºÎ¿ÏÎµÎ¬Ï„Î¹ÎºÎ±' }
            ]
        };


        // All flashcard data, organized by themes and sub-themes
        // The 'allFlashcards' object now acts as a "data definition" map.
        const allFlashcards = {
            'General - Î“ÎµÎ½Î¹ÎºÏŒÏ‚': { // Capitalized
                'general - Î³ÎµÎ½Î¹ÎºÎ¬': [
                    { greek: 'Î¿ ÏƒÎºÏÎ»Î¿Ï‚', english: 'dog' },
                    { greek: 'Î· Î³Î¬Ï„Î±', english: 'cat' },
                    { greek: 'Ï„Î¿ ÏƒÏ€Î¯Ï„Î¹', english: 'house' },
                    { greek: 'Ï„Î¿ Î±Ï…Ï„Î¿ÎºÎ¯Î½Î·Ï„Î¿', english: 'car' },
                    { greek: 'Ï„Î¿ Î´Î­Î½Ï„ÏÎ¿', english: 'tree' }
                ]
            },
            'Numbers - ÎŸÎ¹ Î‘ÏÎ¹Î¸Î¼Î¿Î¯': { // Capitalized
                '0-10': [
                    { english: '0', greek: 'Î¼Î·Î´Î­Î½' },
                    { english: '1', greek: 'Î­Î½Î±' },
                    { english: '2', greek: 'Î´ÏÎ¿' },
                    { english: '3', greek: 'Ï„ÏÎ¯Î±' },
                    { english: '4', greek: 'Ï„Î­ÏƒÏƒÎµÏÎ±' },
                    { english: '5', greek: 'Ï€Î­Î½Ï„Îµ' },
                    { english: '6', greek: 'Î­Î¾Î¹' },
                    { english: '7', greek: 'ÎµÏ€Ï„Î¬' },
                    { english: '8', greek: 'Î¿ÎºÏ„ÏŽ' },
                    { english: '9', greek: 'ÎµÎ½Î½Î­Î±' },
                    { english: '10', greek: 'Î´Î­ÎºÎ±' }
                ],
                '11-100 (Random 20)': "GENERATE_RANDOM_11_100",
                '101-1000 (Random 20)': "GENERATE_RANDOM_101_1000"
            },
            'Nationality - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„ÎµÏ‚': { // Capitalized
                // --- UPDATED: Use magic strings to trigger random 20 generation ---
                'Country - Î§ÏŽÏÎ±': "GET_NATIONALITY_COUNTRY",
                'Nationality (Male) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î±ÏÏƒÎµÎ½Î¹ÎºÏŒ)': "GET_NATIONALITY_MALE",
                'Nationality (Female) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î¸Î·Î»Ï…ÎºÏŒ)': "GET_NATIONALITY_FEMALE",
                'Language - Î“Î»ÏŽÏƒÏƒÎ±': "GET_NATIONALITY_LANGUAGE"
            },
            'The House - Î¤Î¿ Î£Ï€Î¯Ï„Î¹': { // Capitalized
                'the apartment block - Î· Ï€Î¿Î»Ï…ÎºÎ±Ï„Î¿Î¹ÎºÎ¯Î±': [
                    { greek: 'Ï„Î¿ Î´Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î±', english: 'apartment' },
                    { greek: 'Î· Î³ÎºÎ±ÏÏƒÎ¿Î½Î¹Î­ÏÎ±', english: 'studio apartment' },
                    { greek: 'Ï„Î¿ Î´Ï…Î¬ÏÎ¹', english: 'two-room apartment' },
                    { greek: 'Ï„Î¿ Ï„ÏÎ¹Î¬ÏÎ¹', english: 'three-room apartment' },
                    { greek: 'Î· ÎºÏÎµÎ²Î±Ï„Î¿ÎºÎ¬Î¼Î±ÏÎ±', english: 'the bedroom' },
                    { greek: 'Ï„Î¿ Ï…Ï€Î½Î¿Î´Ï‰Î¼Î¬Ï„Î¹Î¿', english: 'the bedroom' },
                    { greek: 'Ï„Î¿ ÏƒÎ±Î»ÏŒÎ½Î¹', english: 'living room' },
                    { greek: 'Î· Ï„ÏÎ±Ï€ÎµÎ¶Î±ÏÎ¯Î±', english: 'dining room' },
                    { greek: 'Î· Ï„Î¿Ï…Î±Î»Î­Ï„Î±', english: 'toilet' },
                    { greek: 'Î¿ Î´Î¹Î¬Î´ÏÎ¿Î¼Î¿Ï‚', english: 'corridor' },
                    { greek: 'Ï„Î¿ Î¼Ï€Î±Î»ÎºÏŒÎ½Î¹', english: 'balcony' },
                    { greek: 'Ï„Î± Ï€Î±ÏÎ¬Î¸Ï…ÏÎ±', english: 'windows' },
                    { greek: 'Î¿ Î±Î½ÎµÎ»ÎºÏ…ÏƒÏ„Î®ÏÎ±Ï‚', english: 'lift' },
                    { greek: 'Ï„Î¿ ÎºÎ¿Ï…Î´Î¿ÏÎ½Î¹', english: 'doorbell' },
                    { greek: 'Î· Î¸Î­ÏƒÎ· ÏƒÏ„Î¬Î¸Î¼ÎµÏ…ÏƒÎ·Ï‚', english: 'parking spot' },
                    { greek: 'Î· ÎºÎµÎ½Ï„ÏÎ¹ÎºÎ® Î¸Î­ÏÎ¼Î±Î½ÏƒÎ·', english: 'central heating system' },
                    { greek: 'Î· Î±Ï…Ï„ÏŒÎ½Î¿Î¼Î· Î¸Î­ÏÎ¼Î±Î½ÏƒÎ·', english: 'autonomous heating system' },
                    { greek: 'Ï„Î± Î­Ï€Î¹Ï€Î»Î±', english: 'furniture' },
                    { greek: 'Î¿Î¹ Î·Î»ÎµÎºÏ„ÏÎ¹ÎºÎ­Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚', english: 'electrical appliances' },
                    { greek: 'Î´Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î± ÎºÎ±Î¹Î½Î¿ÏÏÎ³Î¹Î¿', english: 'new apartment' },
                    { greek: 'Î´Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î± Î±Î½Î±ÎºÎ±Î¹Î½Î¹ÏƒÎ¼Î­Î½Î¿', english: 'renovated apartment' },
                    { greek: 'Î´Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î± Ï†ÏÎµÏƒÎºÎ¿Î²Î±Î¼Î¼Î­Î½Î¿', english: 'fresh painted apartment' },
                    { greek: 'Î´Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î± ÎµÏ€Î¹Ï€Î»Ï‰Î¼Î­Î½Î¿', english: 'furnished apartment' },
                    { greek: 'Ï„Î¿ ÎµÎ½Î¿Î¯ÎºÎ¹Î¿', english: 'rental' },
                    { greek: 'Ï„Î± ÎºÎ¿Î¹Î½ÏŒÏ‡ÏÎ·ÏƒÏ„Î±', english: 'common expenses' }
                ],
                'stand-alone house - Î¼ÏŒÎ½Î¿ÎºÎ±Ï„Î¿Î¹ÎºÎ¯Î±': [
                    // Add words here
                ],
                'house related - ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒ Î¼Îµ Ï„Î¿ ÏƒÏ€Î¯Ï„Î¹': [
                    // Add words here
                ]
            },
            'Inside The House - ÎœÎ­ÏƒÎ± Î£Ï„Î¿ Î£Ï€Î¯Ï„Î¹': { // Capitalized
                'living room - Ï„Î¿ ÏƒÎ±Î»ÏŒÎ½Î¹': [
                    { greek: 'Î¿ ÎºÎ±Î½Î±Ï€Î­Ï‚', english: 'sofa' },
                    { greek: 'Î· Ï€Î¿Î»Ï…Î¸ÏÏŒÎ½Î±', english: 'armchair' },
                    { greek: 'Ï„Î¿ Ï„ÏÎ±Ï€ÎµÎ¶Î¬ÎºÎ¹', english: 'coffee table' },
                    { greek: 'Ï„Î¿ ÏÎ¬Ï†Î¹', english: 'shelf' },
                    { greek: 'Ï„Î¿ Ï†Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÏŒ', english: 'lamp' },
                    { greek: 'Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚', english: 'picture on wall' },
                    { greek: 'Î· ÎºÎ¿Ï…ÏÏ„Î¯Î½Î±', english: 'curtain' },
                    { greek: 'Ï„Î¿ Ï‡Î±Î»Î¯', english: 'carpet' }
                ],
                'bedroom - Ï„Î¿ Ï…Ï€Î½Î¿Î´Ï‰Î¼Î¬Ï„Î¹Î¿': [
                    { greek: 'Ï„Î¿ ÎºÏÎµÎ²Î¬Ï„Î¹', english: 'bed' },
                    { greek: 'Ï„Î¿ ÎºÎ¿Î¼Î¿Î´Î¯Î½Î¿', english: 'bedside table' },
                    { greek: 'Î· Î½Ï„Î¿Ï…Î»Î¬Ï€Î±', english: 'cupboard' },
                    { greek: 'Î¿ ÎºÎ±Î¸ÏÎ­Ï†Ï„Î·Ï‚', english: 'mirror' },
                    { greek: 'Ï„Î± ÏƒÎµÎ½Ï„ÏŒÎ½Î¹Î±', english: 'sheets' },
                    { greek: 'Ï„Î¿ Î¼Î±Î¾Î¹Î»Î¬ÏÎ¹', english: 'pillow' }
                ],
                'bathroom - Ï„Î¿ Î¼Ï€Î¬Î½Î¹Î¿': [
                    { greek: 'Î· Î¼Ï€Î±Î½Î¹Î­ÏÎ±', english: 'bathtub' },
                    { greek: 'Î· Ï„Î¿Ï…Î±Î»Î­Ï„Î±', english: 'toilet' },
                    { greek: 'Ï„Î¿ ÎºÎ±Î¶Î±Î½Î¬ÎºÎ¹', english: 'cistern' },
                    { greek: 'Î· Ï€ÎµÏ„ÏƒÎ­Ï„Î±', english: 'towel' },
                    { greek: 'Ï„Î¿ Ï‡Î±ÏÏ„Î¯ Ï„Î¿Ï…Î±Î»Î­Ï„Î±Ï‚', english: 'toilet paper' },
                    { greek: 'Ï„Î¿ ÎºÎ±Î»Î¬Î¸Î¹', english: 'basket' },
                    { greek: 'Î· ÎºÎ¿Ï…ÏÏ„Î¯Î½Î± Î¼Ï€Î¬Î½Î¹Î¿Ï…', english: 'shower curtain' },
                    { greek: 'Ï„Î¿ Ï‡Î±Î»Î¬ÎºÎ¹', english: 'mat' },
                    { greek: 'Î¿ Î½Î¹Ï€Ï„Î®ÏÎ±Ï‚', english: 'sink (bathroom)' }
                ],
                'kitchen - Î· ÎºÎ¿Ï…Î¶Î¯Î½Î±': [
                    { greek: 'Î¿ Î½ÎµÏÎ¿Ï‡ÏÏ„Î·Ï‚', english: 'sink (kitchen)' },
                    { greek: 'Ï„Î¿ Î½Ï„Î¿Ï…Î»Î¬Ï€Î¹', english: 'cupboard' },
                    { greek: 'Ï„Î¿ ÏƒÏ…ÏÏ„Î¬ÏÎ¹', english: 'drawer' },
                    { greek: 'Ï„Î¿ ÏˆÏ…Î³ÎµÎ¯Î¿', english: 'fridge' },
                    { greek: 'Î¿ Ï†Î¿ÏÏÎ½Î¿Ï‚', english: 'oven' },
                    { greek: 'Î¿ Ï†Î¿ÏÏÎ½Î¿Ï‚ Î¼Î¹ÎºÏÎ¿ÎºÏ…Î¼Î¬Ï„Ï‰Î½', english: 'microwave' },
                    { greek: 'Î· ÎºÎ±Ï„ÏƒÎ±ÏÏŒÎ»Î±', english: 'pot' },
                    { greek: 'Î¿ Î²ÏÎ±ÏƒÏ„Î®ÏÎ±Ï‚', english: 'boiler' },
                    { greek: 'Î¿ Î±Ï€Î¿Ï‡Ï…Î¼Ï‰Ï„Î®Ï‚', english: 'juice maker' },
                    { greek: 'Î· Ï„ÏÎ±Ï€ÎµÎ¶Î±ÏÎ¯Î±', english: 'dining table' },
                    { greek: 'Î· ÎºÎ±ÏÎ­ÎºÎ»Î±', english: 'chair' }
                ]
            }
        };

        // --- STATE ---
        let currentFlashcards = [];
        let currentIndex = 0;
        let isFlipped = false;
        let isGreekToEnglish = true; // true = Grk -> Eng, false = Eng -> Grk
        const SHUFFLE_ALL_KEY = "__SHUFFLE_ALL__";

        // --- ELEMENTS ---
        const themeSelect = document.getElementById('theme-select');
        const subthemeSelect = document.getElementById('subtheme-select');
        const flashcard = document.getElementById('flashcard');
        const cardFront = document.getElementById('card-front');
        const cardBack = document.getElementById('card-back');
        const cardFrontLabel = document.getElementById('card-front-label');
        const cardFrontText = document.getElementById('card-front-text');
        const cardBackLabel = document.getElementById('card-back-label');
        const cardBackText = document.getElementById('card-back-text');
        const progressIndicator = document.getElementById('progress-indicator');
        const flipBtn = document.getElementById('flip-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resetBtn = document.getElementById('reset-btn');
        const directionToggle = document.getElementById('direction-toggle');
        const helpBtn = document.getElementById('help-btn');
        const helpModal = document.getElementById('help-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');

        // --- FUNCTIONS ---

        /**
         * Shuffles an array in place using the Fisher-Yates algorithm.
         * @param {Array} array - The array to shuffle.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        /**
         * Loads the main themes into the theme dropdown.
         */
        function loadThemes() {
            themeSelect.innerHTML = '<option value="" disabled selected>- Select Theme -</option>'; // Add default
            for (const themeKey in allFlashcards) {
                const option = document.createElement('option');
                option.value = themeKey;
                option.textContent = themeKey;
                themeSelect.appendChild(option);
            }
        }

        /**
         * Loads sub-themes based on the selected main theme.
         */
        function loadSubthemes() {
            const selectedTheme = themeSelect.value;
            subthemeSelect.innerHTML = '<option value="" disabled selected>- Select Sub-Theme -</option>'; // Add default
            subthemeSelect.disabled = true;
            
            if (selectedTheme && allFlashcards[selectedTheme]) {
                const subthemes = allFlashcards[selectedTheme];
                for (const subthemeKey in subthemes) {
                    const option = document.createElement('option');
                    // The 'value' is the key (e.g., 'living room...'), 
                    // 'textContent' is also the key (which is what is displayed)
                    option.value = subthemeKey; 
                    option.textContent = subthemeKey;
                    subthemeSelect.appendChild(option);
                }
                
                // Add "Shuffle All" option if there's more than one sub-theme
                if (Object.keys(subthemes).length > 1) {
                    const shuffleOption = document.createElement('option');
                    shuffleOption.value = SHUFFLE_ALL_KEY;
                    shuffleOption.innerHTML = 'ðŸ”€ Shuffle all - Î±Î½Î±ÎºÎ±Ï„Î­ÏˆÏ„Îµ ÏŒÎ»Î± ðŸ”€';
                    shuffleOption.className = "font-bold text-indigo-600";
                    subthemeSelect.appendChild(shuffleOption);
                }

                subthemeSelect.disabled = false;
            }
            loadDeck(); // Load deck (which will be empty if no sub-theme)
        }

        /**
         * Loads the flashcard deck based on selected theme and sub-theme.
         * This function now also handles the dynamic generation of number cards.
         */
        function loadDeck() {
            const themeKey = themeSelect.value;
            const subthemeKey = subthemeSelect.value;
            currentFlashcards = [];

            if (themeKey && subthemeKey && allFlashcards[themeKey]) {
                const subthemeData = allFlashcards[themeKey][subthemeKey];

                if (subthemeKey === SHUFFLE_ALL_KEY) {
                    // 1. Combine all cards from all sub-themes
                    const allSubthemes = allFlashcards[themeKey];
                    for (const key in allSubthemes) {
                        const data = allSubthemes[key];
                        if (Array.isArray(data)) {
                            currentFlashcards.push(...data);
                        } 
                        // --- UPDATED: Handle all generators ---
                        else if (data === "GENERATE_RANDOM_101_1000") {
                            currentFlashcards.push(...generateRandomNumberCards(101, 1000, 20)); 
                        } else if (data === "GENERATE_RANDOM_11_100") {
                            currentFlashcards.push(...generateRandomNumberCards(11, 100, 20)); 
                        }
                        // --- NEW: Add random Nationality cards to shuffle all ---
                        else if (data === "GET_NATIONALITY_COUNTRY") {
                            currentFlashcards.push(...getRandomCards(NATIONALITY_DATA['Country - Î§ÏŽÏÎ±'], 20));
                        } else if (data === "GET_NATIONALITY_MALE") {
                            currentFlashcards.push(...getRandomCards(NATIONALITY_DATA['Nationality (Male) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î±ÏÏƒÎµÎ½Î¹ÎºÏŒ)'], 20));
                        } else if (data === "GET_NATIONALITY_FEMALE") {
                            currentFlashcards.push(...getRandomCards(NATIONALITY_DATA['Nationality (Female) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î¸Î·Î»Ï…ÎºÏŒ)'], 20));
                        } else if (data === "GET_NATIONALITY_LANGUAGE") {
                            currentFlashcards.push(...getRandomCards(NATIONALITY_DATA['Language - Î“Î»ÏŽÏƒÏƒÎ±'], 20));
                        }
                    }
                } else if (Array.isArray(subthemeData)) {
                    // 2. Standard case: Get cards from the specific sub-theme array
                    currentFlashcards = [...subthemeData];
                } 
                // --- UPDATED: Handle all generators ---
                else if (subthemeData === "GENERATE_RANDOM_101_1000") {
                    currentFlashcards = generateRandomNumberCards(101, 1000, 20);
                } else if (subthemeData === "GENERATE_RANDOM_11_100") {
                    currentFlashcards = generateRandomNumberCards(11, 100, 20);
                }
                // --- NEW: Handle Nationality sub-themes ---
                else if (subthemeData === "GET_NATIONALITY_COUNTRY") {
                    currentFlashcards = getRandomCards(NATIONALITY_DATA['Country - Î§ÏŽÏÎ±'], 20);
                } else if (subthemeData === "GET_NATIONALITY_MALE") {
                    currentFlashcards = getRandomCards(NATIONALITY_DATA['Nationality (Male) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î±ÏÏƒÎµÎ½Î¹ÎºÏŒ)'], 20);
                } else if (subthemeData === "GET_NATIONALITY_FEMALE") {
                    currentFlashcards = getRandomCards(NATIONALITY_DATA['Nationality (Female) - Î•Î¸Î½Î¹ÎºÏŒÏ„Î·Ï„Î± (Î¸Î·Î»Ï…ÎºÏŒ)'], 20);
                } else if (subthemeData === "GET_NATIONALITY_LANGUAGE") {
                    currentFlashcards = getRandomCards(NATIONALITY_DATA['Language - Î“Î»ÏŽÏƒÏƒÎ±'], 20);
                }
                
                // --- CONSOLIDATED SHUFFLE/SLICE LOGIC ---
                if (currentFlashcards.length > 0) {
                    // Always shuffle the resulting deck
                    shuffleArray(currentFlashcards);

                    // If it's the "Shuffle All" option and the deck is large, pick 20
                    if (subthemeKey === SHUFFLE_ALL_KEY && currentFlashcards.length > 20) {
                        currentFlashcards = currentFlashcards.slice(0, 20);
                    }
                }
                // --- END OF NEW LOGIC ---
            }
            
            currentIndex = 0;
            // Ensure card is facing front when loading a new deck
            if (isFlipped) {
                flashcard.classList.remove('is-flipped');
                isFlipped = false;
            }
            updateCard();
            updateNavButtons();

            // Remove focus from the dropdown so spacebar works for flipping
            subthemeSelect.blur();
        }

        /**
         * Updates the content displayed on the flashcard.
         */
        function updateCard() {
            const wasFlipped = isFlipped; // Capture the state before any changes

            // Unflip the card if it's flipped (e.g., when moving next/prev)
            if (wasFlipped) {
                flashcard.classList.remove('is-flipped');
                isFlipped = false;
            }

            // Wait for flip animation to finish before updating text
            // Set timeout to 0 if not flipped, so it updates instantly
            setTimeout(() => {
                if (currentFlashcards.length === 0) {
                    // Show instructions
                    cardFrontLabel.style.display = 'none'; // Hide "Greek" label
                    cardFrontText.textContent = "Choose a Theme and Sub-Theme to practice.";
                    cardFrontText.className = "text-xl font-bold text-indigo-600 text-center"; 

                    cardBackLabel.style.display = 'none'; // Hide "English" label
                    cardBackText.textContent = "Choose a Theme and Sub-Theme to practice.";
                    cardBackText.className = "text-xl font-bold text-indigo-200 text-center"; // Lighter indigo for dark bg

                    progressIndicator.textContent = "Waiting for selection...";
                    return; // Stop here
                }

                // Restore normal labels and styles if we have cards
                cardFrontLabel.style.display = 'block';
                cardBackLabel.style.display = 'block';
                
                const card = currentFlashcards[currentIndex];

                // Logic for toggle direction
                if (isGreekToEnglish) {
                    // Front: Greek
                    cardFrontLabel.textContent = "Greek";
                    cardFrontLabel.className = "self-start text-sm font-medium text-gray-500";
                    cardFrontText.textContent = card.greek;
                    cardFrontText.className = "text-3xl md:text-4xl font-bold text-indigo-600 text-center px-4";

                    // Back: English
                    cardBackLabel.textContent = "English";
                    cardBackLabel.className = "self-start text-sm font-medium text-indigo-100";
                    cardBackText.textContent = card.english;
                    cardBackText.className = "text-3xl md:text-4xl font-bold text-white text-center px-4";
                } else {
                    // Front: English
                    cardFrontLabel.textContent = "English";
                    cardFrontLabel.className = "self-start text-sm font-medium text-gray-500";
                    cardFrontText.textContent = card.english;
                    cardFrontText.className = "text-3xl md:text-4xl font-bold text-indigo-600 text-center px-4";

                    // Back: Greek
                    cardBackLabel.textContent = "Greek";
                    cardBackLabel.className = "self-start text-sm font-medium text-indigo-100";
                    cardBackText.textContent = card.greek;
                    cardBackText.className = "text-3xl md:text-4xl font-bold text-white text-center px-4";
                }

                progressIndicator.textContent = `${currentIndex + 1} / ${currentFlashcards.length}`;
            }, wasFlipped ? 300 : 0); // Use the captured state to determine delay
        }

        /**
         * Updates the enabled/disabled state of nav buttons.
         */
        function updateNavButtons() {
            const hasCards = currentFlashcards.length > 0;
            flipBtn.disabled = !hasCards;
            prevBtn.disabled = !hasCards || currentIndex === 0;
            nextBtn.disabled = !hasCards || currentIndex === currentFlashcards.length - 1;
        }

        /**
         * Flips the flashcard.
         */
        function flipCard() {
            if (currentFlashcards.length === 0) return;
            isFlipped = !isFlipped;
            flashcard.classList.toggle('is-flipped');
        }

        /**
         * Shows the next card in the deck.
         */
        function nextCard() {
            if (currentIndex < currentFlashcards.length - 1) {
                currentIndex++;
                updateCard();
                updateNavButtons();
            }
        }

        /**
         * Shows the previous card in the deck.
         */
        function prevCard() {
            if (currentIndex > 0) {
                currentIndex--;
                updateCard();
                updateNavButtons();
            }
        }

        /**
         * Resets the application to its initial state without reloading.
         */
        function resetApp() {
             // Reset dropdowns
            themeSelect.selectedIndex = 0;
            loadSubthemes(); // This will reset subthemes and call loadDeck()
        }

        /**
         * Toggles the card direction and updates the card.
         */
        function toggleDirection() {
            isGreekToEnglish = !isGreekToEnglish;
            directionToggle.classList.toggle('toggled');
            
            // Unflip the card and update its content to match new direction
            if (isFlipped) {
                flashcard.classList.remove('is-flipped');
                isFlipped = false;
            }
            updateCard();
        }

        // --- EVENT LISTENERS ---
        document.addEventListener('DOMContentLoaded', () => {
            loadThemes();
            loadSubthemes(); // Will load empty/default state
            updateNavButtons(); // Disable buttons initially
        });

        themeSelect.addEventListener('change', loadSubthemes);
        subthemeSelect.addEventListener('change', loadDeck);
        flipBtn.addEventListener('click', flipCard);
        directionToggle.addEventListener('click', toggleDirection);
        
        // Add click listeners to the card itself to flip
        flashcard.addEventListener('click', (e) => {
            if (e.target.tagName !== 'BUTTON') {
                flipCard();
            }
        }); 
        
        prevBtn.addEventListener('click', prevCard);
        nextBtn.addEventListener('click', nextCard);
        resetBtn.addEventListener('click', resetApp);

        // --- Modal Listeners ---
        helpBtn.addEventListener('click', () => {
            helpModal.classList.remove('hidden');
        });

        closeModalBtn.addEventListener('click', () => { // --- FIX WAS HERE ---
            helpModal.classList.add('hidden');
        });

        // Close modal if clicking on the background overlay
        helpModal.addEventListener('click', (e) => {
            if (e.target === helpModal) {
                helpModal.classList.add('hidden');
            }
        });

        // Add keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Don't interfere if user is typing in a select box
            if (document.activeElement === themeSelect || document.activeElement === subthemeSelect) {
                return;
            }
            
            if (currentFlashcards.length === 0) return; // Don't do anything if no cards

            switch (e.key) {
                case 'ArrowLeft':
                    if (!prevBtn.disabled) {
                        prevBtn.click();
                    }
                    break;
                case 'ArrowRight':
                    if (!nextBtn.disabled) {
                        nextBtn.click();
                    }
                    break;
                case ' ': // Space bar
                case 'ArrowUp':
                case 'ArrowDown':
                    e.preventDefault(); // Stop space from scrolling
                    if (!flipBtn.disabled) {
                        flipBtn.click();
                    }
                    break;
            }
        });

    </script>
</body>
</html>


